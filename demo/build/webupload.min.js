!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Webupload=void 0;var i=n(1),a=o(i);e.Webupload=a.default},function(t,e,n){"use strict";function o(t){if(this.options={el:"",url:"",limit:"9",ext:["png","jpg"],auto:!0,data:[],success:function(){},finish:function(){},loadend:function(){},error:function(){}},this.options=a.extend(this.options,t),this.el=document.getElementById(this.options.el),this.imgList=null,this.id="",this.data=[],!this.el)throw new Error("未指定el.");this._init()}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(2);n(3);var r=0;o.prototype={_init:function(){this.data=[],this.count=0,this._correctExt(),this._generateID(),this._renderDOM(),this.el=document.getElementById(this.options.el),this.imgList=document.getElementById("webupload"+this.id).querySelector(".webupload-list"),this.btn=document.getElementById("webupload"+this.id).querySelector(".webupload-btn"),this._bindDeleteHanlde(),this._watch()},_renderDOM:function(){var t=this,e=document.createElement("ul");e.className="webupload-list";var n=0,o=0;["width","paddingLeft","paddingRight","borderLeft","borderRight"].forEach(function(e,o,i){n+=a.getStyle(t.el,e)?parseFloat(a.getStyle(t.el,e)):0}),["height","paddingTop","paddingBottom","borderTop","borderBottom"].forEach(function(e,n,i){o+=a.getStyle(t.el,e)?parseFloat(a.getStyle(t.el,e)):0}),n=0==n?"auto":n+"px",o=0==o?"auto":o+"px",this.el.outerHTML='<div class="webupload" id="webupload'+this.id+'"><div class="webupload-handle" style="position:relative; z-index:1; width:'+n+"; height:"+o+'; overflow:hidden;">'+this.el.outerHTML+'<input class="webupload-btn" type="file" name="images" multiple="multiple" style="position:absolute;z-index:1;left:-80px;;top:0; bottom:0; right:0; opacity:0;cursor:pointer;"></div>'+e.outerHTML+"</div>"},_bindDeleteHanlde:function(){var t=this;a.event.addHandler(this.imgList,"click",function(e){var n=a.event.getTarget(e);if("webupload-item-delete"==n.className){var o=n.parentNode,i=Array.prototype.slice.call(t.imgList.querySelectorAll("li")).indexOf(o);o.parentNode.removeChild(o),t.data.splice(i,1)}})},_generateID:function(){r++,this.id=r},_correctExt:function(){for(var t=this.options.ext,e=t.length,n=0;n<e;n++)if("jpg"==t[n]){t[n]="jpeg";break}},_loadend:function(t,e){var n=document.createElement("li"),o=document.createElement("img"),i=document.createElement("span"),a=document.createElement("i");o.src=t,o.className="webupload-item",n.style.position="relative",n.appendChild(o),i.className="webupload-item-progress",i.style.position="absolute",i.style.transition="width 0.5s",i.style.opacity="0.5",i.style.width="0",n.appendChild(i),a.className="webupload-item-delete",a.style.position="absolute",n.appendChild(a),this.imgList.appendChild(n),this.options.loadend(t,e)},_watch:function(){var t=this,e=t.options.ext.length>0;this.btn.addEventListener("change",function(n){var o,i,a=0,r=this.files.length;if(this.files.length>t.options.limit)return void t.options.error("最多上传"+t.options.limit+"个文件");for(t.data=[],t.count=0;a<r;a++){i=this.files[a];var s=new FormData;if(s.append("images",i,i.name),t.data.push(s),e&&!t._filterType(this.files[a]))break;window.FileReader&&(o=new FileReader,o.onloadend=function(e){t._loadend(e.target.result,i.name)},o.readAsDataURL(i))}t.options.auto&&t.upload()},!1)},_filterType:function(t){for(var e=this.options.ext,n=e.length,o=!1,i=0;i<n;i++)if(t.type.indexOf(e[i])>-1){o=!0;break}return o||this.options.error("文件格式不正确"),o},_upload:function(t,e){var n=this;this._setExtraData(t);var o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&(o.status>=200&&o.status<300||304==o.status?(n.count++,n.options.success(n.count,n.data.length),n.count==n.data.length&&n.options.finish()):n.options.error(o.status))},o.open("POST",this.options.url,!0),o.setRequestHeader("Cache-Control","no-cache"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.upload.onprogress=function(t){if(console.log(e),event.lengthComputable){var o=event.loaded/event.total*100+"%";n.imgList.querySelectorAll("li")[e].querySelector(".webupload-item-progress").style.width=o}},t.fake?(o.setRequestHeader("Content-Type","multipart/form-data; boundary="+t.boundary),o.sendAsBinary(t.toString())):o.send(t)},_setExtraData:function(t){var e=this.options.data;if("object"==("undefined"==typeof e?"undefined":i(e))){var n;for(n in e)t.append(n,e[n])}},upload:function(){for(var t=0,e=this.data.length;t<e;t++)this._upload(this.data[t],t)}},window.Webupload=o,e.default=o},function(t,e){"use strict";e.extend=function(t){for(var e,n=Array.prototype.slice.call(arguments,1),o=0;e=n[o];o++)if(e)for(var i in e)t[i]=e[i];return t},e.ajax=function(t){function e(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject){if("string"!=typeof arguments.callee.activeXString)for(var t=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],e=0,n=t.length;e<n;e++)try{var o=new ActiveXObject(t[e]);return arguments.callee.activeXString=t[e],o}catch(t){}return new ActiveXObject(arguments.callee.activeXString)}throw new Error("NO XHR object available.")}t.error=t.error|function(){};var n={},o=function(t,e){n[t.toLowerCase()]=[t,e]};o("Content-Type",t.contentType||"application/x-www-form-urlencoded; charset=UTF-8");var i=e();i.onreadystatechange=function(){4==i.readyState&&(i.status>=200&&i.status<300||304==i.status?t.success(i.responseText):t.error(i.status))},i.open(t.type,t.url,!0);for(name in n)i.setRequestHeader.apply(i,n[name]);"post"==t.type?i.send(t.data):i.send(null)},e.getStyle=function(t,e){return window.getComputedStyle?window.getComputedStyle(t,null)[e]:t.currentStyle[e]},e.event={getEvent:function(t){return t?t:window.event},getTarget:function(t){return t.target||t.srcElement},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},addHandler:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},removeHandler:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}}},function(t,e){"use strict";!function(t){function e(){this.fake=!0,this.boundary="--------FormData"+Math.random(),this._fields=[]}t.FormData||(e.prototype.append=function(t,e){this._fields.push([t,e])},e.prototype.toString=function(){var t=this.boundary,e="";return this._fields.forEach(function(n){if(e+="--"+t+"\r\n",n[1].name){var o=n[1];e+='Content-Disposition: form-data; name="'+n[0]+'"; filename="'+o.name+'"\r\n',e+="Content-Type: "+o.type+"\r\n\r\n",e+=o.getAsBinary()+"\r\n"}else e+='Content-Disposition: form-data; name="'+n[0]+'";\r\n\r\n',e+=n[1]+"\r\n"}),e+="--"+t+"--"},t.FormData=e)}(window)}]);