!function(e){function t(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Webupload=void 0;var i=o(1),a=n(i);t.Webupload=a.default},function(e,t,o){"use strict";function n(e){if(this.options={el:"",url:"",limit:"9",maxSize:"2048",ext:["png","jpg"],auto:!0,data:[],showSize:!1,showName:!1,startUpload:function(){},success:function(){},finishUpload:function(){},loadend:function(){},change:function(){},error:function(){}},this.options=a.extend(this.options,e),this.el=document.getElementById(this.options.el),this.imgList=null,this.id="",this.data=[],this.count=0,!this.el)throw new Error("未指定el.");this._init()}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=o(2);o(3);var s=0;n.prototype={_init:function(){this.crop="object"==i(this.options.crop),this._correctExt(),this._generateID(),this._renderDOM(),this.el=document.getElementById(this.options.el),this.imgList=document.getElementById("webupload"+this.id).querySelector(".webupload-list"),this.btn=document.getElementById("webupload"+this.id).querySelector(".webupload-btn"),this._bindHanlde(),this._watch()},_renderDOM:function(){var e=this,t=document.createElement("ul");t.className="webupload-list";var o=e.el.offsetWidth+"px",n=e.el.offsetHeight+"px",i="";i=this.crop?'<input class="webupload-btn" type="file" name="images" style="position:absolute;z-index:1;left:-80px;;top:0; bottom:0; right:0; opacity:0;">':'<input class="webupload-btn" type="file" name="images" multiple="multiple" style="position:absolute;z-index:1;left:-80px;;top:0; bottom:0; right:0; opacity:0;">',this.el.outerHTML='<div class="webupload" id="webupload'+this.id+'"><div class="webupload-handle" style="position:relative; z-index:1; width:'+o+"; height:"+n+'; overflow:hidden;">'+this.el.outerHTML+i+"</div>"+t.outerHTML+"</div>"},_bindHanlde:function(){var e=this;this.crop||a.event.on(this.imgList,"click",function(t){var o=a.event.getTarget(t);if("webupload-item-delete"==o.className){var n=o.parentNode,i=Array.prototype.slice.call(e.imgList.querySelectorAll("li")).indexOf(n);n.parentNode.removeChild(n),e.data.splice(i,1)}})},_generateID:function(){s++,this.id=s},_correctExt:function(){for(var e=this.options.ext,t=e.length,o=0;o<t;o++)if("jpg"==e[o]){e[o]="jpeg";break}},_loadend:function(e,t){var o=document.createElement("li");o.className="webupload-item",o.style.position="relative";var n=document.createElement("img");if(n.src=e,this.crop){var i=document.createElement("div");i.className="webupload-item-crop",i.style.position="relative",i.style.width=n.width+"px",i.style.height=n.height+"px",i.appendChild(n);var a=document.createElement("div");a.className="webupload-item-crop-mask",a.style.cssText="position:absolute;left:0;top:0;z-index:1;width:"+n.width+"px;height:"+n.height+"px;background:rgba(0,0,0,0.5);",i.appendChild(a);var s=document.createElement("div");s.className="webupload-item-crop-area",s.style.position="absolute",s.style.width=this.options.crop.width?this.options.crop.width-2+"px":"98px",s.style.height=this.options.crop.height?this.options.crop.height-2+"px":"98px",s.style.border="solid 1px #39f",s.style.background="#fff";var r=n.cloneNode(!0),l=document.createElement("div");l.className="webupload-item-crop-area-move",l.style.position="relative",r.className="webupload-item-crop-area-img",r.style.position="absolute",l.appendChild(r),s.appendChild(l);var p=document.createElement("i");p.className="webupload-item-crop-line webupload-item-crop-line1";var d=document.createElement("i");d.className="webupload-item-crop-line webupload-item-crop-line2";var u=document.createElement("i");u.className="webupload-item-crop-line webupload-item-crop-line3";var c=document.createElement("i");if(c.className="webupload-item-crop-line webupload-item-crop-line4",this.options.crop.zoom){p.style.cursor="n-resize",d.style.cursor="e-resize",u.style.cursor="s-resize",c.style.cursor="w-resize",s.appendChild(p),s.appendChild(d),s.appendChild(u),s.appendChild(c);var m=document.createElement("i");m.className="webupload-item-crop-point webupload-item-crop-point1",s.appendChild(m);var h=document.createElement("i");h.className="webupload-item-crop-point webupload-item-crop-point2",s.appendChild(h);var f=document.createElement("i");f.className="webupload-item-crop-point webupload-item-crop-point3",s.appendChild(f);var v=document.createElement("i");v.className="webupload-item-crop-point webupload-item-crop-point4",s.appendChild(v);var y=document.createElement("i");y.className="webupload-item-crop-point webupload-item-crop-point5",s.appendChild(y);var b=document.createElement("i");b.className="webupload-item-crop-point webupload-item-crop-point6",s.appendChild(b);var w=document.createElement("i");w.className="webupload-item-crop-point webupload-item-crop-point7",s.appendChild(w);var g=document.createElement("i");g.className="webupload-item-crop-point webupload-item-crop-point8",s.appendChild(g)}else s.appendChild(p),s.appendChild(d),s.appendChild(u),s.appendChild(c);i.appendChild(s),o.appendChild(i)}else{if(o.appendChild(n),this.options.showName){var x=document.createElement("p");x.className="webupload-item-name",x.innerHTML=t.name,o.appendChild(x)}if(this.options.showSize){var E=document.createElement("p");E.className="webupload-item-size",E.innerHTML=(t.size/1e3).toFixed(2)+"kb",o.appendChild(E)}var S=document.createElement("i");S.className="webupload-item-delete",S.style.position="absolute",o.appendChild(S);var C=document.createElement("span");C.className="webupload-item-progress",C.style.position="absolute",C.style.transition="width 0.5s",C.style.opacity="0.5",C.style.width="0",o.appendChild(C)}var _=document.createElement("p");if(_.className="webupload-item-error",o.appendChild(_),this.crop)for(;this.imgList.childNodes.length;)this.imgList.removeChild(this.imgList.childNodes[this.imgList.childNodes.length-1]);this.imgList.appendChild(o),this.crop&&this._handleCrop(n)},_handleCrop:function(e){function t(e,t){var o=a.event.getEvent(e);a.event.preventDefault(o),a.event.stopPropagation(o),y=t,h=parseFloat(a.getStyle(n,"left")),f=parseFloat(a.getStyle(n,"top")),b=n.offsetWidth,w=n.offsetHeight,v.x=a.event.getPointerPositionInDocument(o).x,v.y=a.event.getPointerPositionInDocument(o).y,a.event.on(document,"mousemove",S)}var o=this,n=this.imgList.querySelector(".webupload-item-crop-area"),i=n.querySelector(".webupload-item-crop-area-img"),s=n.querySelector(".webupload-item-crop-line1"),r=n.querySelector(".webupload-item-crop-line2"),l=n.querySelector(".webupload-item-crop-line3"),p=n.querySelector(".webupload-item-crop-line4"),d=n.querySelector(".webupload-item-crop-point1"),u=n.querySelector(".webupload-item-crop-point3"),c=n.querySelector(".webupload-item-crop-point5"),m=n.querySelector(".webupload-item-crop-point7"),h=0,f=0,v={x:0,y:0},y="",b=n.offsetWidth,w=n.offsetHeight;this.thumb={},this.thumb.thumb_width=b,this.thumb.thumb_height=w,this.thumb.thumb_x=v.x,this.thumb.thumb_y=v.y;var g=b/w,x=document.getElementById(this.options.crop.cropResult),E=null;x&&(x.style.width=this.options.crop.width?this.options.crop.width+"px":"100px",x.style.height=this.options.crop.height?this.options.crop.height+"px":"100px",x.style.overflow="hidden",x.style.position="relative",x.innerHTML='<img src="'+e.src+'" style="position:absolute;"/>',E=x.querySelector("img"));var S=function(t){var t=a.event.getEvent(t),s=a.event.getPointerPositionInDocument(t).x-v.x,r=a.event.getPointerPositionInDocument(t).y-v.y;if("s"==y||"se"==y){var l=b+Math.round(r*g)-2,p=w+r-2;h+l>e.width&&(l=e.width-h,p=l/g),n.style.width=l+"px",n.style.height=p+"px"}else if("w"==y||"sw"==y)n.style.width=b+-s-2+"px",n.style.height=w+-Math.round(s*g)-2+"px";else if("e"==y||"ne"==y)n.style.width=b+s-2+"px",n.style.height=w+Math.round(s*g)-2+"px";else if("n"==y||"nw"==y)n.style.width=b+-Math.round(r*g)-2+"px",n.style.height=w+-r-2+"px";else{var d=s+h,u=r+f,c=e.width-n.offsetWidth,m=e.height-n.offsetHeight;d<0&&(d=0),d>c&&(d=c),u<0&&(u=0),u>m&&(u=m),n.style.left=d+"px",n.style.top=u+"px",i.style.left=-d+"px",i.style.top=-u+"px",E&&(E.style.left=-d-1+"px",E.style.top=-u-1+"px")}o.thumb.thumb_width=n.offsetWidth,o.thumb.thumb_height=n.offsetWidth,o.thumb.thumb_x=d,o.thumb.thumb_y=u},C=function(e){a.event.off(document,"mousemove",S)};a.event.on(n,"mousedown",function(e){t(e,"move")}),a.event.on(document,"mouseup",C),this.options.crop.zoom&&(a.event.on(s,"mousedown",function(e){t(e,"n")}),a.event.on(r,"mousedown",function(e){t(e,"e")}),a.event.on(l,"mousedown",function(e){t(e,"s")}),a.event.on(p,"mousedown",function(e){t(e,"w")}),a.event.on(d,"mousedown",function(e){t(e,"nw")}),a.event.on(u,"mousedown",function(e){t(e,"ne")}),a.event.on(c,"mousedown",function(e){t(e,"se")}),a.event.on(m,"mousedown",function(e){t(e,"sw")}),a.event.on(s,"mouseup",C),a.event.on(r,"mouseup",C),a.event.on(l,"mouseup",C),a.event.on(p,"mouseup",C),a.event.on(d,"mouseup",C),a.event.on(u,"mouseup",C),a.event.on(c,"mouseup",C),a.event.on(m,"mouseup",C))},_watch:function(){var e=this,t=e.options.ext.length>0;this.btn.addEventListener("change",function(o){e.options.change();var n,i=0,a=this.files.length;if(this.files.length>e.options.limit)return void e.options.error("最多上传"+e.options.limit+"个文件");for(;i<a;i++){if(n=this.files[i],e.data.length>=e.options.limit){e.options.error("最多上传"+e.options.limit+"个文件");break}if(t&&!e._filterType(n)){e.options.error("文件"+n.name+"类型错误");break}if(n.size/1e3>e.options.maxSize){e.options.error("文件"+n.name+"超过"+e.options.maxSize+"kb");break}if(!window.FileReader||"image/jpeg"!=n.type&&"image/png"!=n.type&&"image/gif"!=n.type){var s=new FormData;s.append("images",n,n.name),e.data.push(s)}else!function(t){var o=new FileReader;o.onloadend=function(o){var n=new FormData;n.append("images",t,t.name),e.data.push(n),e._loadend(o.target.result,t)},o.readAsDataURL(t)}(n)}e.options.auto&&e.upload()},!1)},_filterType:function(e){for(var t=this.options.ext,o=t.length,n=!1,i=0;i<o;i++)if(e.type.indexOf(t[i])>-1){n=!0;break}return n||this.options.error("文件格式不正确"),n},_uploadStop:function(){this.data=[],this.count=0,this.btn.disabled=!1,this.el.classList.remove("disabled")},_upload:function(e,t){var o=this;this._setExtraData(e);var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&(n.status>=200&&n.status<300||304==n.status?(o.count++,o.options.success(o.count,o.data.length),o.count==o.data.length&&(o._uploadStop(),o.options.finishUpload())):(o._uploadStop(),o.imgList.querySelectorAll("li")[t].querySelector(".webupload-item-error").innerHTML="上传失败，xhr.status"+n.status))},n.open("POST",this.options.url,!0),n.setRequestHeader("Cache-Control","no-cache"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.upload.onprogress=function(e){if(event.lengthComputable&&!o.crop){var n=event.loaded/event.total*100+"%";o.imgList.querySelectorAll("li")[t].querySelector(".webupload-item-progress").style.width=n}},e.fake?(n.setRequestHeader("Content-Type","multipart/form-data; boundary="+e.boundary),n.sendAsBinary(e.toString())):n.send(e)},_setExtraData:function(e){var t=this.options.data;if("object"==("undefined"==typeof t?"undefined":i(t))){var o;for(o in t)e.append(o,t[o])}if(this.crop)for(o in this.thumb)e.append(o,this.thumb[o])},upload:function(){var e=0,t=this.data.length;if(0!=t)for(this.options.startUpload(),this.btn.disabled=!0,this.el.classList.add("disabled");e<t;e++)this._upload(this.data[e],e)}},window.Webupload=n,t.default=n},function(e,t){"use strict";t.extend=function(e){for(var t,o=Array.prototype.slice.call(arguments,1),n=0;t=o[n];n++)if(t)for(var i in t)e[i]=t[i];return e},t.ajax=function(e){function t(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject){if("string"!=typeof arguments.callee.activeXString)for(var e=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],t=0,o=e.length;t<o;t++)try{var n=new ActiveXObject(e[t]);return arguments.callee.activeXString=e[t],n}catch(e){}return new ActiveXObject(arguments.callee.activeXString)}throw new Error("NO XHR object available.")}e.error=e.error|function(){};var o={},n=function(e,t){o[e.toLowerCase()]=[e,t]};n("Content-Type",e.contentType||"application/x-www-form-urlencoded; charset=UTF-8");var i=t();i.onreadystatechange=function(){4==i.readyState&&(i.status>=200&&i.status<300||304==i.status?e.success(i.responseText):e.error(i.status))},i.open(e.type,e.url,!0);for(name in o)i.setRequestHeader.apply(i,o[name]);"post"==e.type?i.send(e.data):i.send(null)},t.getStyle=function(e,t){return window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.currentStyle[t]},t.event={getEvent:function(e){return e?e:window.event},getTarget:function(e){return e.target||e.srcElement},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getPointerPositionInDocument:function(e){var t=e.pageX||e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),o=e.pageY||e.clientY+(document.documentElement.scrollTop||document.body.scrollTop);return{x:t,y:o}},on:function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent?e.attachEvent("on"+t,o):e["on"+t]=o},off:function(e,t,o){e.removeEventListener?e.removeEventListener(t,o,!1):e.detachEvent?e.detachEvent("on"+t,o):e["on"+t]=null}}},function(e,t){"use strict";!function(e){function t(){this.fake=!0,this.boundary="--------FormData"+Math.random(),this._fields=[]}e.FormData||(t.prototype.append=function(e,t){this._fields.push([e,t])},t.prototype.toString=function(){var e=this.boundary,t="";return this._fields.forEach(function(o){if(t+="--"+e+"\r\n",o[1].name){var n=o[1];t+='Content-Disposition: form-data; name="'+o[0]+'"; filename="'+n.name+'"\r\n',t+="Content-Type: "+n.type+"\r\n\r\n",t+=n.getAsBinary()+"\r\n"}else t+='Content-Disposition: form-data; name="'+o[0]+'";\r\n\r\n',t+=o[1]+"\r\n"}),t+="--"+e+"--"},e.FormData=t)}(window)}]);