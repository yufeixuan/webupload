!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Webupload=void 0;var i=n(1),a=o(i);t.Webupload=a.default},function(e,t,n){"use strict";function o(e){if(this.options={el:"",url:"",limit:"9",maxSize:"1024",ext:["png","jpg"],auto:!0,data:[],showSize:!1,showName:!1,startUpload:function(){},success:function(){},finishUpload:function(){},loadend:function(){},change:function(){},error:function(){}},this.options=a.extend(this.options,e),this.el=document.getElementById(this.options.el),this.imgList=null,this.id="",this.data=[],this.count=0,!this.el)throw new Error("未指定el.");this._init()}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(2);n(3);var r=0;o.prototype={_init:function(){this._correctExt(),this._generateID(),this._renderDOM(),this.el=document.getElementById(this.options.el),this.imgList=document.getElementById("webupload"+this.id).querySelector(".webupload-list"),this.btn=document.getElementById("webupload"+this.id).querySelector(".webupload-btn"),this._bindDeleteHanlde(),this._watch()},_renderDOM:function(){var e=this,t=document.createElement("ul");t.className="webupload-list";var n=0,o=0;["width","paddingLeft","paddingRight","borderLeft","borderRight"].forEach(function(t,o,i){n+=a.getStyle(e.el,t)?parseFloat(a.getStyle(e.el,t)):0}),["height","paddingTop","paddingBottom","borderTop","borderBottom"].forEach(function(t,n,i){o+=a.getStyle(e.el,t)?parseFloat(a.getStyle(e.el,t)):0}),n=0==n?"auto":n+"px",o=0==o?"auto":o+"px",this.el.outerHTML='<div class="webupload" id="webupload'+this.id+'"><div class="webupload-handle" style="position:relative; z-index:1; width:'+n+"; height:"+o+'; overflow:hidden;">'+this.el.outerHTML+'<input class="webupload-btn" type="file" name="images" multiple="multiple" style="position:absolute;z-index:1;left:-80px;;top:0; bottom:0; right:0; opacity:0;"></div>'+t.outerHTML+"</div>"},_bindDeleteHanlde:function(){var e=this;a.event.addHandler(this.imgList,"click",function(t){var n=a.event.getTarget(t);if("webupload-item-delete"==n.className){var o=n.parentNode,i=Array.prototype.slice.call(e.imgList.querySelectorAll("li")).indexOf(o);o.parentNode.removeChild(o),e.data.splice(i,1)}})},_generateID:function(){r++,this.id=r},_correctExt:function(){for(var e=this.options.ext,t=e.length,n=0;n<t;n++)if("jpg"==e[n]){e[n]="jpeg";break}},_loadend:function(e,t){var n=document.createElement("li"),o=document.createElement("img"),i=document.createElement("span"),a=document.createElement("p"),r=document.createElement("i");if(o.src=e,o.className="webupload-item",n.style.position="relative",n.appendChild(o),i.className="webupload-item-progress",i.style.position="absolute",i.style.transition="width 0.5s",i.style.opacity="0.5",i.style.width="0",n.appendChild(i),this.options.showName){var s=document.createElement("p");s.className="webupload-item-name",s.innerHTML=t.name,n.appendChild(s)}if(this.options.showSize){var l=document.createElement("p");l.className="webupload-item-size",l.innerHTML=(t.size/1e3).toFixed(2)+"kb",n.appendChild(l)}a.className="webupload-item-error",n.appendChild(a),r.className="webupload-item-delete",r.style.position="absolute",n.appendChild(r),this.imgList.appendChild(n),this.options.loadend(e,t)},_watch:function(){var e=this,t=e.options.ext.length>0;this.btn.addEventListener("change",function(n){e.options.change();var o,i,a=0,r=this.files.length;if(this.files.length>e.options.limit)return void e.options.error("最多上传"+e.options.limit+"个文件");for(;a<r;a++){if(i=this.files[a],e.data.length>=e.options.limit){e.options.error("最多上传"+e.options.limit+"个文件");break}if(t&&!e._filterType(i)){e.options.error("文件"+i.name+"类型错误");break}if(i.size/1e3>e.options.maxSize){e.options.error("文件"+i.name+"超过"+e.options.maxSize+"kb");break}var s=new FormData;s.append("images",i,i.name),e.data.push(s),!window.FileReader||"image/jpeg"!=i.type&&"image/png"!=i.type&&"image/gif"!=i.type||(o=new FileReader,o.onloadend=function(t){e._loadend(t.target.result,i)},o.readAsDataURL(i))}e.options.auto&&e.upload()},!1)},_filterType:function(e){for(var t=this.options.ext,n=t.length,o=!1,i=0;i<n;i++)if(e.type.indexOf(t[i])>-1){o=!0;break}return o||this.options.error("文件格式不正确"),o},_uploadStop:function(){this.data=[],this.count=0,this.btn.disabled=!1,this.el.classList.remove("disabled")},_upload:function(e,t){var n=this;this._setExtraData(e);var o=new XMLHttpRequest;console.log(o),o.onreadystatechange=function(){4==o.readyState&&(o.status>=200&&o.status<300||304==o.status?(n.count++,n.options.success(n.count,n.data.length),n.count==n.data.length&&(n._uploadStop(),n.options.finishUpload())):(n._uploadStop(),n.imgList.querySelectorAll("li")[t].querySelector(".webupload-item-error").innerHTML="上传失败，xhr.status"+o.status))},o.open("POST",this.options.url,!0),o.setRequestHeader("Cache-Control","no-cache"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.upload.onprogress=function(e){if(event.lengthComputable){var o=event.loaded/event.total*100+"%";n.imgList.querySelectorAll("li")[t].querySelector(".webupload-item-progress").style.width=o}},e.fake?(o.setRequestHeader("Content-Type","multipart/form-data; boundary="+e.boundary),o.sendAsBinary(e.toString())):o.send(e)},_setExtraData:function(e){var t=this.options.data;if("object"==("undefined"==typeof t?"undefined":i(t))){var n;for(n in t)e.append(n,t[n])}},upload:function(){var e=0,t=this.data.length;if(0!=t)for(this.options.startUpload(),this.btn.disabled=!0,this.el.classList.add("disabled");e<t;e++)this._upload(this.data[e],e)}},window.Webupload=o,t.default=o},function(e,t){"use strict";t.extend=function(e){for(var t,n=Array.prototype.slice.call(arguments,1),o=0;t=n[o];o++)if(t)for(var i in t)e[i]=t[i];return e},t.ajax=function(e){function t(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject){if("string"!=typeof arguments.callee.activeXString)for(var e=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],t=0,n=e.length;t<n;t++)try{var o=new ActiveXObject(e[t]);return arguments.callee.activeXString=e[t],o}catch(e){}return new ActiveXObject(arguments.callee.activeXString)}throw new Error("NO XHR object available.")}e.error=e.error|function(){};var n={},o=function(e,t){n[e.toLowerCase()]=[e,t]};o("Content-Type",e.contentType||"application/x-www-form-urlencoded; charset=UTF-8");var i=t();i.onreadystatechange=function(){4==i.readyState&&(i.status>=200&&i.status<300||304==i.status?e.success(i.responseText):e.error(i.status))},i.open(e.type,e.url,!0);for(name in n)i.setRequestHeader.apply(i,n[name]);"post"==e.type?i.send(e.data):i.send(null)},t.getStyle=function(e,t){return window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.currentStyle[t]},t.event={getEvent:function(e){return e?e:window.event},getTarget:function(e){return e.target||e.srcElement},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}}},function(e,t){"use strict";!function(e){function t(){this.fake=!0,this.boundary="--------FormData"+Math.random(),this._fields=[]}e.FormData||(t.prototype.append=function(e,t){this._fields.push([e,t])},t.prototype.toString=function(){var e=this.boundary,t="";return this._fields.forEach(function(n){if(t+="--"+e+"\r\n",n[1].name){var o=n[1];t+='Content-Disposition: form-data; name="'+n[0]+'"; filename="'+o.name+'"\r\n',t+="Content-Type: "+o.type+"\r\n\r\n",t+=o.getAsBinary()+"\r\n"}else t+='Content-Disposition: form-data; name="'+n[0]+'";\r\n\r\n',t+=n[1]+"\r\n"}),t+="--"+e+"--"},e.FormData=t)}(window)}]);